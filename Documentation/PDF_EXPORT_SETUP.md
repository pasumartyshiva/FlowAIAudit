# PDF Export Setup Guide

## Overview
The Flow Analysis Dashboard now supports exporting analysis reports to PDF from two locations:
1. **LWC Dashboard** - "Export to PDF" button in the detail modal
2. **Record Page Layout** - Custom button on Flow_Analysis__c record

---

## ‚úÖ Already Deployed

### 1. LWC Dashboard Export
- **Location:** Detail modal when viewing flow analysis
- **Button:** "Export to PDF" (blue, bottom left)
- **Action:** Downloads HTML file ‚Üí Open it ‚Üí Print to PDF (Ctrl+P or Cmd+P)
- **Status:** ‚úÖ Live and ready to use

### 2. Visualforce PDF Page
- **File:** `FlowAnalysisExport.page`
- **Purpose:** Renders Flow_Analysis__c record as professional PDF
- **Features:**
  - Clean header with flow info
  - Status badges (color-coded)
  - Full analysis report
  - Professional footer with timestamp
- **Status:** ‚úÖ Deployed

---

## üîß Setup: Add "Export to PDF" Button to Page Layout

### Step 1: Create Custom Button

1. **Navigate to:** Setup ‚Üí Object Manager ‚Üí Flow Analysis ‚Üí Buttons, Links, and Actions
2. **Click:** New Button or Link
3. **Fill in:**
   ```
   Label: Export to PDF
   Name: Export_to_PDF
   Display Type: Detail Page Button
   Behavior: Display in existing window without sidebar or header
   Content Source: Visualforce Page
   ```
4. **Select Visualforce Page:** `FlowAnalysisExport`
5. **Click:** Save

### Step 2: Add Button to Page Layout

1. **Navigate to:** Setup ‚Üí Object Manager ‚Üí Flow Analysis ‚Üí Page Layouts
2. **Click:** Flow Analysis Layout (or your active layout)
3. **Click:** Mobile & Lightning Actions or Buttons section
4. **Drag** "Export to PDF" button to the buttons section at the top
5. **Click:** Save

### Step 3: Test It

1. Open any Flow_Analysis__c record
2. Click **"Export to PDF"** button at the top
3. PDF opens in browser (or downloads depending on browser settings)
4. **Print/Save:** Use Ctrl+P (Cmd+P on Mac) or browser's download button

---

## üì± How to Use

### From LWC Dashboard:

1. Click **"View Details"** on any flow
2. Modal opens with analysis
3. Click **"Export to PDF"** (bottom left, blue button)
4. HTML file downloads
5. **Open the HTML file** in your browser
6. **Click the blue "Print to PDF" button** (bottom right) OR press Ctrl+P / Cmd+P
7. **Save as PDF** from the print dialog

### From Record Page:

1. Navigate to any Flow_Analysis__c record
2. Click **"Export to PDF"** button at the top
3. PDF renders directly in browser
4. **Save/Print:** Use Ctrl+P or browser's download button

---

## üé® What's Included in the PDF

### Header Section:
- Flow Name
- API Name
- Status (with color badge)
- Overall Score
- Flow Version
- Last Analyzed Date

### Content Section:
- Full HTML analysis report
- Detailed findings with severity badges
- Recommendations by category
- Strengths and risks

### Footer:
- "Generated by Flow AI Audit Dashboard"
- Timestamp
- Copyright notice

---

## ‚öôÔ∏è Customization Options

### Change PDF Styling

Edit the Visualforce page:
```bash
force-app/main/default/pages/FlowAnalysisExport.page
```

**Examples:**
- Add company logo: Add `<img>` tag in header
- Change colors: Modify CSS color values
- Add custom footer: Edit `.footer` div content
- Adjust margins: Change `@page { margin: 1in; }`

### Add Fields to PDF

In the Visualforce page, add new table rows:
```html
<tr>
    <td>Custom Field:</td>
    <td><apex:outputField value="{!Flow_Analysis__c.Custom_Field__c}"/></td>
</tr>
```

---

## üêõ Troubleshooting

### "Export to PDF" button not visible on record
**Solution:** Complete Step 2 above to add button to page layout

### PDF shows "No analysis report available"
**Solution:** The flow hasn't been analyzed yet. Click "Re-analyze" first.

### Download doesn't work in LWC
**Solution:**
- Check browser popup blocker settings
- Try from an incognito/private window
- Some browsers may block downloads - use Record Page export instead

### Formatting issues in PDF
**Solution:**
- Ensure Analysis_Report__c field contains valid HTML
- Check that field type is Rich Text Area (Long)
- Verify field length limit (131,072 characters)

---

## üìä Browser Compatibility

| Browser | LWC Export | VF Page Export |
|---------|------------|----------------|
| Chrome | ‚úÖ Works | ‚úÖ Works |
| Firefox | ‚úÖ Works | ‚úÖ Works |
| Safari | ‚úÖ Works | ‚úÖ Works |
| Edge | ‚úÖ Works | ‚úÖ Works |

**Note:** LWC export downloads HTML, then user prints to PDF. VF page generates PDF directly.

---

## üéØ Best Practices

1. **Use VF Page Export for:**
   - Sharing with stakeholders
   - Archiving reports
   - Bulk exports

2. **Use LWC Export for:**
   - Quick exports during analysis
   - Customizing before printing
   - Adding annotations

3. **For Automated Exports:**
   - Consider creating a batch process
   - Use the VF page URL pattern:
     ```
     /apex/FlowAnalysisExport?id={recordId}
     ```

---

## üöÄ Future Enhancements

Consider adding:
- **Batch PDF Export** - Export multiple flows at once
- **Email PDF** - Send PDF via email from record
- **Scheduled Reports** - Auto-generate PDFs monthly
- **Custom Branding** - Add company logo and colors
- **Executive Summary** - One-page overview PDF option

---

**Setup Complete!** You can now export flow analysis reports to PDF from both the dashboard and record pages. üéâ
